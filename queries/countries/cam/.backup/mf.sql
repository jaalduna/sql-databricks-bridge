-- source: cam/queries.py::get_mf()
-- description: retrieve the mf table with power bi's structure

select
    idartigo,
    a.idsector,
    sector,
    a.idproduto,
    produto,
    idsub,
    sub,
    idconteudo,
    conteudo,
    mwp_ready,
    mwp_idpl,
    mwp_pl,
    mwp_idcompany,
    mwp_company,
    mwp_idbrand,
    mwp_brand,
    mwp_idvariety,
    mwp_variety,
    mwp_idav,
    mwp_addedvalue,
    idfabricante,
    fabricante,
    idmarca,
    marca,
    cdc01,
    clas01,
    cdc02,
    clas02,
    cdc03,
    clas03,
    cdc04,
    clas04,
    cdc05,
    clas05,
    flggranel,
    granel,
    coef1,
    unicoef1,
    coef2,
    unicoef2,
    coef3,
    unicoef3,
    flgativo,
    codbar,
    codbar2,
    codbar3,
    flgpack,
    unidadespack,
    idartigoind,
    a.dtcriacao,
    fonteinfo,
    nroactos,
    lastmonth,
    avgprice,
    considerar,
    considerarooh,
    p.flgdesativacao,
    p.idcategoria
from vw_artigoz
left join a_produto on a.idproduto = p.idproduto
